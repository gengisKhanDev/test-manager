<template name="desktop_my_proyects">
	<div class="my-proyects">
		<div class="container p-5">
			{{#each proyects}}
			<h1>{{proyectName}}</h1>
			{{/each}}
			<ul class="nav nav-pills mb-3 border-bottom border-2" id="pills-tab" role="tablist">
				<li class="nav-item" role="presentation">
					<button class="nav-link text-primary fw-semibold active position-relative" id="pills-contact-tab"
						data-bs-toggle="pill" data-bs-target="#pills-contact" type="button" role="tab"
						aria-controls="pills-contact" aria-selected="true">Datos del proyecto</button>
				</li>
				{{#if (isNotRole "Desarrollador")}}
				{{#if (isNotRole "Tester")}}
				<li class="nav-item" role="presentation">
					<button class="nav-link text-primary fw-semibold position-relative" id="pills-dashboard-tab"
						data-bs-toggle="pill" data-bs-target="#pills-dashboard" type="button" role="tab"
						aria-controls="pills-dashboard" aria-selected="false">Agregar Usuarios</button>
				</li>
				{{/if}}
				{{/if}}

				{{#if (isNotRole "Desarrollador")}}
				{{#if (isNotRole "Tester")}}
				<li class="nav-item" role="presentation">
					<button class="nav-link text-primary fw-semibold position-relative" id="pills-reportes-tab"
						data-bs-toggle="pill" data-bs-target="#pills-reportes" type="button" role="tab"
						aria-controls="pills-reportes" aria-selected="false">Reportes</button>
				</li>
				{{/if}}
				{{/if}}

				{{#if (hasRole "Desarrollador")}}
				<li class="nav-item" role="presentation">
					<button class="nav-link text-primary fw-semibold position-relative" id="pills-desarrollador-tab"
						data-bs-toggle="pill" data-bs-target="#pills-desarrollador" type="button" role="tab"
						aria-controls="pills-desarrollador" aria-selected="false"><i class="fas fa-users-cog"></i>
						Desarrollador</button>
				</li>
				{{/if}}
				{{#if (hasRole "Tester")}}
				<li class="nav-item" role="presentation">
					<button class="nav-link text-primary fw-semibold position-relative" id="pills-tester-tab"
						data-bs-toggle="pill" data-bs-target="#pills-tester" type="button" role="tab"
						aria-controls="pills-tester" aria-selected="false"><i class="fas fa-vial"></i> Tester</button>
				</li>
				{{/if}}
				{{#if (hasRole "Creador")}}
				<li class="nav-item" role="presentation">
					<button class="nav-link text-primary fw-semibold position-relative" id="pills-creator-tab"
						data-bs-toggle="pill" data-bs-target="#pills-creator" type="button" role="tab"
						aria-controls="pills-creator" aria-selected="false"><i class="fas fa-user-tie"></i>
						Creador</button>
				</li>
				{{/if}}

			</ul>

			<div class="tab-content border rounded-3 border-primary p-3 text-danger" id="pills-tabContent">

				<div class="tab-pane fade show active" id="pills-contact" role="tabpanel"
					aria-labelledby="pills-contact-tab">
					{{#each proyects}}
					<h4><strong> Nombre del proyecto:</strong> {{proyectName}}</h4>
					<p><strong>Creado por:</strong> {{createdBy.name}}</p>
					<p><strong>Fecha de creaci칩n:</strong> {{formatDate createdAt}}</p>
					<p><strong>Descripci칩n:</strong> {{descriptionProyect}}</p>
					{{/each}}
				</div>

				<div class="tab-pane fade" id="pills-dashboard" role="tabpanel" aria-labelledby="pills-dashboard-tab">
					<div class="card-proyect">
						<div class="row row-cols-1 row-cols-xs-2 row-cols-sm-2 row-cols-lg-4 g-3">

							<!-- Formulario fijo -->
							<div class="col">
								<div class="card h-100 shadow-sm p-4">
									<form id="enviarInvitacion">

										<div class="row">
											<div class="col-12">
												<div class="form-group">
													<label for="email">Agrega Correo del participante</label>
													<input type="email" class="form-control" id="email"
														placeholder="Correo electr칩nico" autocomplete="off" required>
												</div>
											</div>
										</div>

										<div class="row">
											<div class="col-12">
												<div class="form-group">
													<label for="roleId">Select Role:</label>
													<select class="form-control select2" id="roleId" required
														data-placeholder="Select role...">
														<option value="">Select role...</option>
														{{#each roles}}
														<option value="{{this.id}}">{{this.name}}</option>
														{{/each}}
													</select>
												</div>
											</div>
										</div>

										<div class="row">
											<div class="col-12 mt-4">
												<div class="d-grid">
													<button type="submit" class="btn btn-primary btn-block"
														id="editUserBtn">
														<i class="fas fa-edit"></i> Enviar
													</button>
												</div>
											</div>
										</div>
									</form>
								</div>
							</div>

							<!-- Tarjetas din치micas -->
							{{#each teamMember in teamMembers}}
							{{#if (eq teamMember.status "accepted")}}
							<div class="col">
								<div class="card h-100 shadow-sm">
									<div class="card-header">
										<span class="close-icon">&times;</span>
									</div>
									<div class="text-center">
										<div class="img-hover-zoom img-hover-zoom--colorize">
											<img class="shadow" src="/iconouserimage.jpg" alt="User Image">
										</div>
									</div>
									<div class="card-body">
										<div class="clearfix mb-3"></div>
										<div class="my-2 text-center">

											<h1>{{teamMember.profile.firstName}} {{teamMember.profile.lastName}}</h1>
										</div>
										<div class="mb-3">
											<h2 class="text-uppercase text-center role">{{teamMember.role}}</h2>
										</div>
										<div class="box">
											<div>
											</div>
										</div>
									</div>
								</div>
							</div>
							{{else}}
							<div class="col">
								<div class="card h-100 shadow-sm">
									<div class="my-2 text-center">
										<i class="fas fa-plus text"></i>
									</div>
								</div>
							</div>
							{{/if}}
							{{/each}}

						</div>
					</div>
				</div>

				<div class="tab-pane fade" id="pills-desarrollador" role="tabpanel"
					aria-labelledby="pills-desarrollador-tab">
					<button class="btn btn-primary btn-block float-end m-4" id="downloadGuidePdf">Descargar
						Guia</button>
					<div class="container mt-5">
						<div class="accordion" id="accordionExampleDeveloper">
							{{#each testsForDeveloper}}
							<div class="accordion-item">
								<h2 class="accordion-header" id="heading{{_id}}">
									<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
										data-bs-target="#collapse{{_id}}" aria-expanded="false"
										aria-controls="collapse{{_id}}">
										{{testType}}
									</button>
								</h2>
								<div id="collapse{{_id}}" class="accordion-collapse collapse"
									aria-labelledby="heading{{_id}}" data-bs-parent="#accordionExampleDeveloper">
									<div class="accordion-body">
										{{#if $eq status "pending review"}}
										<h2>pendiente de revision por parte del tester</h2>
										{{else}}
										<p>Creado por: {{createdBy.name}}</p>
										<p>Estado: {{testStatus status}}</p>
										<p>Comentarios del Tester: {{development.resolution.comments}}</p>
										<div class="row row-cols-1 row-cols-xs-2 row-cols-sm-2 row-cols-lg-4 g-3">
											{{#if $mapped images}}
											{{#each image in images}}
											<div class="col">
												<div class="card h-100 shadow-sm p-4">
													<img src="{{image.base64}}" alt="{{image.name}}" width="100%"
														height="auto" data-id="{{image.id}}"
														class="default-image animate__animated animate__fadeInLeft">
												</div>
											</div>
											{{/each}}
											{{else}}
											<h2 class="text-center">No Images</h2>
											{{/if}}
										</div>
										{{#if $eq status "resolved"}}
										<img src="/TerminadoSello.png" style="position: absolute;  top: 75%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 35%;" alt="">
										{{else}}
										<form id="developerComments" data-id="{{_id}}">
											<div class="row my-4">
												<div class="col-12">
													<div class="drop-zone" id="desarrolladorImage">
														<input type="file" accept="image/*" class="file">
														<h4 class="text">Agregar Evidencia</h4>
													</div>
												</div>
											</div>
											<div class="row mt-4 pb-5">
												<div class="col-12 pb-5">
													<div id="quillEditorContainer-{{_id}}"
														class="quill-editor-container">
													</div>
												</div>
											</div>
											<button type="submit" class="btn btn-primary mt-4">Enviar</button>
										</form>
										{{/if}}
										{{/if}}
									</div>
								</div>
							</div>
							{{/each}}
						</div>
					</div>
				</div>

				<div class="tab-pane fade" id="pills-tester" role="tabpanel" aria-labelledby="pills-tester-tab">
					<button class="btn btn-primary btn-block float-end m-4" id="addTestModal">Agregar Prueba</button>
					<div class="container mt-5">
						<div class="accordion" id="accordionExampleTester">
							{{#each testsForTester}}
							<div class="accordion-item">
								<h2 class="accordion-header" id="heading{{_id}}">
									<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
										data-bs-target="#collapse{{_id}}" aria-expanded="false"
										aria-controls="collapse{{_id}}">
										{{testType}}
									</button>
								</h2>
								<div id="collapse{{_id}}" class="accordion-collapse collapse"
									aria-labelledby="heading{{_id}}" data-bs-parent="#accordionExampleTester">
									<div class="accordion-body">
										<p>Creado por: {{createdBy.name}}</p>
										<p>Estado: {{testStatus status}}</p>
										<p>Comentarios del Tester: {{development.resolution.comments}}</p>

										<div class="ql-editor" style="height: 100% !important;">
											<div>{{{content}}}</div>
										</div>

										<h3>Evidencias</h3>
										<!-- Formulario fijo -->

										<div class="row row-cols-1 row-cols-xs-2 row-cols-sm-2 row-cols-lg-4 g-3">
											{{#if $mapped images}}
											{{#each image in images}}
											<div class="col">
												<div class="card h-100 shadow-sm p-4">

													<img src="{{image.base64}}" alt="{{image.name}}" width="100%"
														height="auto" data-id="{{image.id}}"
														class="default-image animate__animated animate__fadeInLeft">

												</div>
											</div>
											{{/each}}
											{{else}}
											<h2 class="text-center">No Images</h2>
											{{/if}}
										</div>

										{{#if $eq status "pending review"}}

										<div class="row my-4">
											<div class="col-12">
												<div class="drop-zone" id="devueltaImage">
													<input type="file" accept="image/*" class="file">
													<h4 class="text">Agregar Evidencia</h4>
												</div>
											</div>
										</div>
										<div class="row p-2">
											<div class="col-12">
												<div class="form-group">
													<textarea class="developer-comments form-control"
														id="commentsErrores"
														placeholder="Add your comments..."></textarea>
												</div>
											</div>
											<div class="col-6">
												<button class="btn btn-primary mt-2 float-end" id="aceptarSeguimiento"
													data-id="{{_id}}">Aceptar</button>
											</div>
											<div class="col-6">
												<button class="btn btn-danger mt-2" id="rechazarSeguimiento"
													data-id="{{_id}}">Devolver</button>
											</div>
										</div>

										{{/if}}
									</div>
								</div>
							</div>
							{{/each}}
						</div>
					</div>
				</div>

				<div class="tab-pane fade" id="pills-reportes" role="tabpanel" aria-labelledby="pills-reportes-tab">
					{{#each allTestsForProject}}
					<div class="row m-2">
						<div class="d-grid">
							<button class="btn btn-primary" id="PDFInformeTest" data-id="{{_id}}">
								Descargar PDF del Informe del Test {{testType}}
							</button>
						</div>
					</div>
					{{/each}}
				</div>


			</div>
		</div>
	</div>
	{{> add_test_modal}}

</template>